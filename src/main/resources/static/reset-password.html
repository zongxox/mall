<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

</body>
</html><!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>重設密碼 - Clothique</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
    :root{
      --bg:#0f1220; --panel:#161a2f; --text:#e9eef7; --muted:#b6bdd1;
      --brand:#7c5cff; --brand2:#6ae3ff; --success:#34d399; --danger:#ff6b6b;
      --ring:0 0 0 .16rem rgba(106,227,255,.45); --radius:16px; --shadow:0 10px 30px rgba(0,0,0,.25);
    }
    *{box-sizing:border-box}
    html,body{height:100%}

    /* 背景與字體：同驗證信箱頁 */
    body{
      margin:0;
      font-family:'Noto Sans TC',system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      color:var(--text);
      background:
              radial-gradient(800px 350px at 85% 0%, rgba(106,227,255,.16), transparent 60%),
              radial-gradient(800px 350px at 0% 10%, rgba(124,92,255,.18), transparent 60%),
              var(--bg);
      display:flex; align-items:center; justify-content:center; padding:20px;
    }

    /* 卡片盒：用 reset-box 對應你的 HTML */
    .reset-box{
      width:min(420px, 92vw);
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.12);
      border-radius:16px;
      padding:28px;
      box-shadow:var(--shadow);
      text-align:left;
    }

    /* 標題 */
    h2{
      margin:0 0 8px;
      font-size:22px; font-weight:700; color:var(--text);
      text-align:center;
    }

    /* 說明/錯誤訊息 */
    .message{
      margin-top:8px;
      text-align:center;
      color:var(--danger);
      font-size:14px;
    }

    /* 標籤與輸入框 */
    label{
      display:block; margin:14px 0 8px;
      font-weight:700; color:var(--muted); font-size:14px;
    }
    input[type="password"]{
      width:100%;
      padding:14px 16px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.16);
      background:rgba(255,255,255,.06);
      color:var(--text);
      font-size:15px;
      outline:0;
      transition:border .2s, box-shadow .2s, background .2s;
    }
    input[type="password"]::placeholder{ color:rgba(233,238,247,.45); }
    input[type="password"]:focus{
      border-color:rgba(106,227,255,.45);
      box-shadow:var(--ring);
      background:rgba(255,255,255,.08);
    }

    /* 按鈕（沿用品牌藍紫漸層） */
    button{
      width:100%;
      padding:12px 16px;
      border:0; outline:0; cursor:pointer;
      border-radius:999px;
      font-size:16px; font-weight:800;
      color:#0b0f1f;
      background:linear-gradient(90deg, var(--brand) 0%, var(--brand2) 100%);
      transition:transform .08s ease, opacity .2s ease;
    }
    button:hover{ transform:translateY(-1px); opacity:.95; }
    button:active{ transform:translateY(0); opacity:.9; }

    /* 亮色模式適配（同驗證信箱頁處理） */
    @media (prefers-color-scheme: light){
      body{ background:#f6f7fb; color:#121622; }
      .reset-box{
        background:#fff; border:1px solid #e8ecf4; color:#121622;
        box-shadow:0 8px 20px rgba(0,0,0,.08);
      }
      label{ color:#556; }
      input[type="password"]{
        background:#f7f8fb; color:#121622; border-color:#e8ecf4;
      }
    }

  </style>
</head>
<body>

<div class="reset-box">
  <h2>重設密碼</h2>
  <form id="resetForm">
    <label for="newPassword">請輸入新密碼</label>
    <input type="password" id="newPassword" placeholder="至少 6 位數" required>
    <button type="submit">確認重設</button>
    <div class="message" id="message"></div>
  </form>
</div>
<script>

  $(function() {
    // 2. 發送AJAX請求
    $("#resetForm").on("submit",function (event) {
      event.preventDefault();
      const urlToken = new URLSearchParams(window.location.search);
      const token = urlToken.get("resetToken");
      if(token === null){
        $("#resetForm").hide();
        return;
      }
      const newPassword = $("#newPassword").val().trim();
      if(newPassword===null||newPassword.length<6){
        $("#message").text("請至少輸入6位數,含英文")
        return;
      }
      const url = "/user/resetPassword";
      $.ajax({
        url: url,    // 目標後端URL
        type: "POST",           // 或 "POST"、"PUT"、"DELETE"
        dataType: "json",      // 預期回傳資料型態
        contentType: "application/json", // (POST才需要)
        data: JSON.stringify({resetToken:token,password:newPassword}),
        success: function(response) {
          if (response.code === 200) {
            // 例如塞進表格、顯示成功訊息
            alert("密碼修改成功！");
            window.location.href="login.html"
          } else {
            alert("密碼修改失敗!" + response.msg);
            window.location.href="login2.html"
          }
        },
        error: function(xhr) {
          // 4. 失敗的話會執行這裡
          console.error(xhr);
          alert("系統錯誤！");
        }
      });
    });


    });

</script>

</body>
</html>