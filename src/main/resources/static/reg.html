<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>購物商城註冊</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f1220; --panel:#161a2f; --card:#1a1f3a; --text:#e9eef7; --muted:#b6bdd1;
      --brand:#7c5cff; --brand-2:#6ae3ff; --danger:#ff6b6b; --success:#34d399;
      --ring:0 0 0 .16rem rgba(106,227,255,.45); --radius:16px; --shadow:0 10px 30px rgba(0,0,0,.25);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;font-family:'Noto Sans TC',system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; color:var(--text);
      background:
              radial-gradient(1000px 600px at 10% 10%, rgba(124,92,255,.25), transparent 60%),
              radial-gradient(1000px 700px at 90% 20%, rgba(106,227,255,.18), transparent 60%),
              linear-gradient(180deg,#0f1220 0%,#0f1220 100%);
    }
    .page{min-height:100dvh;display:grid;grid-template-columns:1.1fr 1fr;gap:clamp(20px,4vw,40px);align-items:center;padding:clamp(16px,3vw,36px);max-width:1200px;margin:0 auto}
    .visual{display:none}
    .visual .card{background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow)}
    .visual img{display:block;width:100%;height:auto}
    .auth-card{background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);padding:clamp(20px,3.2vw,32px);box-shadow:var(--shadow)}
    .brand{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:14px}
    .brand h1{font-size:clamp(22px,2.2vw,28px);margin:0;letter-spacing:.3px}
    .brand .login-link{color:var(--brand-2);text-decoration:none;font-weight:500;white-space:nowrap}
    .subtitle{color:var(--muted);margin-bottom:16px;font-size:14px}

    form{display:grid;gap:14px}
    .field{display:grid;gap:8px}
    label{font-weight:600;font-size:14px}
    .control{display:flex;align-items:center;gap:10px;background:#0f1330;border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:10px 12px;transition:box-shadow .15s ease,border-color .15s ease,background .15s ease}
    .control:focus-within{box-shadow:var(--ring);border-color:rgba(106,227,255,.6);background:#10163a}
    .control input{flex:1;min-width:0;border:0;outline:0;background:transparent;color:var(--text);font-size:16px;padding:4px 2px}

    /* HTML5 的視覺提示仍保留（不靠 checkValidity 流程） */
    input[required]:invalid{box-shadow:0 0 0 2px rgba(255,107,107,.25) inset}
    input[required]:valid{box-shadow:0 0 0 2px rgba(52,211,153,.2) inset}

    .hint{font-size:12px;color:var(--muted)}
    .actions{display:grid;gap:10px;margin-top:8px}
    .btn{appearance:none;border:0;outline:0;cursor:pointer;border-radius:999px;padding:12px 16px;font-weight:700;font-size:16px;color:#0a0f1f;background:linear-gradient(90deg,var(--brand) 0%,var(--brand-2) 100%)}
    .btn[disabled]{opacity:.6;cursor:not-allowed}
    .message{text-align:center;margin-top:6px;font-size:14px;min-height:20px}
    .agree{display:flex;align-items:start;gap:10px;font-size:13px;color:var(--muted)}
    .agree input{margin-top:2px}

    #header-container{margin-bottom:14px}

    @media (min-width:900px){.visual{display:block}}
    @media (max-width:899px){.page{grid-template-columns:1fr}.brand{align-items:start;flex-direction:column;gap:6px}}
  </style>
</head>
<body>
<div id="header-container"></div>

<main class="page">
  <section class="visual" aria-hidden="true">
    <div class="card">
      <a href="index.html"><img src="images/reg.jpg" alt="註冊視覺圖"/></a>
    </div>
  </section>

  <section>
    <div class="auth-card">
      <div class="brand">
        <h1>建立商城購物帳號</h1>
        <a class="login-link" href="login.html">已有帳號？前往登入 →</a>
      </div>

      <!-- jQuery 接管表單 -->
      <form id="regForm" novalidate>
        <div class="field">
          <label for="account">帳號</label>
          <div class="control">
            <input id="account" name="account" placeholder="請輸入帳號"
                   autocomplete="username"
                   required minlength="3" maxlength="30" />
          </div>
          <span class="hint">8–10 個字元，建議使用英數組合。</span>
        </div>

        <div class="field">
          <label for="password">密碼</label>
          <div class="control">
            <input id="password" name="password" type="password" placeholder="請輸入密碼"
                   autocomplete="new-password"
                   required />
          </div>
          <span class="hint">至少 8 碼，需包含英文字母與數字。</span>
        </div>

        <div class="field">
          <label for="name">姓名</label>
          <div class="control">
            <input id="name" name="name" placeholder="請輸入姓名" required />
          </div>
        </div>

        <div class="field">
          <label for="phone">電話</label>
          <div class="control">
            <input id="phone" name="phone" type="phone" inputmode="numeric"
                   placeholder="請輸入電話（僅數字）" required />
          </div>
          <span class="hint">請輸入 8–15 位數字，不含符號與空白。</span>
        </div>

        <div class="field">
          <label for="email">電子信箱</label>
          <div class="control">
            <input id="email" name="email" type="email" placeholder="name@example.com"
                   autocomplete="email" required />
          </div>
        </div>

        <div class="actions">
          <button id="submitBtn" type="submit" class="btn">註冊</button>
          <div id="msg" class="message"></div>
        </div>
      </form>
    </div>
  </section>
</main>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script>
  $(function() {
    $("form").on("submit",function (event) {
      event.preventDefault();//阻止表單送出
      //設置api路徑
      const url = "/user/saveUser";
      const data = {
      account:$("#account").val().trim(),
      password:$("#password").val().trim(),
      name:$("#name").val().trim(),
      phone:$("#phone").val().trim(),
      email:$("#email").val().trim()
      };

      //data的屬性是否是空值
      if(!data.account||!data.password||!data.name||!data.phone||!data.email){
        $("#msg").text("所有欄位皆為必填");
        return;
      }

      //判斷email格式
      const emailRegex = /^[a-zA-Z0-9]+@[a-zA-Z]+\.[a-zA-Z]{2,}$/;
      if(!emailRegex.test(data.email)){
        $("#msg").text("email格式不對");
        return;
      }
      // 2. 發送AJAX請求
      $.ajax({
        url: url,    // 目標後端URL
        type: "POST",           // 或 "POST"、"PUT"、"DELETE"
        dataType: "json",      // 預期回傳資料型態
        contentType: "application/json", // (POST才需要)
        data: JSON.stringify(data), //把data往後端送
        success: function(response) {
          //先判斷是否成功
          if (response.code === 200) {
            //在標籤id為msg的裡面顯示成功訊息
            // 3. 成功的話會執行這裡
            $("#msg").text("註冊成功,請前往信箱驗證");
            alert("註冊成功請前往信箱進行驗證");
            window.location.href="/login.html";
          } else {
            $("#msg").text("註冊失敗");
          }
        },
        error: function(xhr) {
          // 4. 失敗的話會執行這裡
          console.error(xhr);
          alert("系統錯誤！");
        }
      });
    });
  });
</script>
</body>
</html>
